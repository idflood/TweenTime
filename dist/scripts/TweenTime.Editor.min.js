!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("signals"),require("lodash"),require("d3"),require("jquery"),require("draggable-number.js"),require("spectrum-colorpicker"),require("file-saver")):"function"==typeof define&&define.amd?define(["signals","lodash","d3","jquery","DraggableNumber","spectrum","file-saver"],e):"object"==typeof exports?exports.Editor=e(require("signals"),require("lodash"),require("d3"),require("jquery"),require("draggable-number.js"),require("spectrum-colorpicker"),require("file-saver")):(t.TweenTime=t.TweenTime||{},t.TweenTime.Editor=e(t.signals,t._,t.d3,t.$,t.DraggableNumber,t.spectrum,t.saveAs))}(this,function(t,e,i,n,r,a,s){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(7),o=n(s),l=i(17),u=n(l),c=i(33),h=n(c),d=i(35),p=n(d),f=i(36),v=n(f),m=i(37),y=n(m),g=i(38),b=n(g),_=i(39),k=i(3),w=function(){function t(e){var i=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,t),this.tweenTime=e,this.options=n,this.timer=this.tweenTime.timer,this.lastTime=-1,this.onKeyAdded=this.onKeyAdded.bind(this),this.onKeyRemoved=this.onKeyRemoved.bind(this),this.forceItemsRender=this.forceItemsRender.bind(this);var a=n.el||$("body");this.el=a,this.$timeline=$(_()),a.append(this.$timeline),a.addClass("has-editor"),this.selectionManager=new v["default"](this.tweenTime),this.exporter=new y["default"](this),this.timeline=new o["default"](this,n),this.propertiesEditor=new u["default"](this,this.selectionManager),this.propertiesEditor.keyAdded.add(this.onKeyAdded),this.propertiesEditor.keyRemoved.add(this.onKeyRemoved),this.menu=new h["default"](this.tweenTime,this.$timeline,this),void 0!==this.options.onMenuCreated&&this.options.onMenuCreated(this.$timeline.find(".timeline__menu"),this),this.controls=new p["default"](this.tweenTime,this.$timeline),this.undoManager=new b["default"](this),this.onSelect=new k.Signal;var s=this;this.selectionManager.onSelect.add(function(t,e){s.onSelect.dispatch(t,e)}),window.editorEnabled=!0,window.dispatchEvent(new Event("resize")),window.requestAnimationFrame(function(){return i.update()})}return a(t,[{key:"forceItemsRender",value:function(){this.timeline._isDirty=!0}},{key:"select",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.selectionManager.select(t,e)}},{key:"getSelection",value:function(){return this.selectionManager.getSelection()}},{key:"onKeyAdded",value:function(){this.undoManager.addState(),this.render(!1,!1,!0)}},{key:"onKeyRemoved",value:function(t){this.selectionManager.removeItem(t._id),this.undoManager.addState(),this.selectionManager.selection.length&&this.selectionManager.triggerSelect(),this.render(!1,!1,!0)}},{key:"render",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],n=t;n===!1&&(n=this.timer.time[0]),i&&(this.timeline._isDirty=!0),this.timeline.render(n,e),this.controls.render(n,e),this.propertiesEditor.render(n,e)}},{key:"update",value:function(){var t=this,e=this.timer.time[0],i=this.lastTime!==e;this.render(e,i),this.lastTime=this.timer.time[0],window.requestAnimationFrame(function(){return t.update()})}}]),t}();t.exports=w},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(){i(this,t)}return n(t,null,[{key:"formatMinutes",value:function(t){var e=t/1e3,i=Math.floor(e/3600),n=Math.floor((e-3600*i)/60);e-=60*n;var r=e+"s";return n&&(r=n+"m "+r),i&&(r=i+"h "+r),r}},{key:"getClosestTime",value:function(t,e){var i=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],n=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],r=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],a=arguments.length<=5||void 0===arguments[5]?.1:arguments[5];if(r){var s=r.getCurrentTime()/1e3;if(Math.abs(s-e)<=a)return s}if(i||n)for(var o=0;o<t.length;o++){var l=t[o];if(l.id!==i||n){if(Math.abs(l.start-e)<=a)return l.start;if(Math.abs(l.end-e)<=a)return l.end}for(var u=0;u<l.properties.length;u++){var c=l.properties[u];if(c.keys&&(l.id!==i||c.name!==n))for(var h=0;h<c.keys.length;h++){var d=c.keys[h];if(Math.abs(d.time-e)<=a)return d.time}}}return!1}},{key:"getPreviousKey",value:function(t,e){for(var i=!1,n=0;n<t.length;n++){var r=t[n];if(!(r.time<e))return i;i=r}return i}},{key:"sortKeys",value:function(t){var e=function(t,e){return t.time<e.time?-1:t.time>e.time?1:0};return t.sort(e)}},{key:"guid",value:function(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}]),t}();e["default"]=r},,function(e,i){e.exports=t},,,function(t,i){t.exports=e},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(1),o=n(s),l=i(8),u=n(l),c=i(10),h=n(c),d=i(11),p=n(d),f=i(12),v=n(f),m=i(13),y=n(m),g=i(14),b=n(g),_=i(15),k=n(_),w=i(16),x=n(w),T=i(9),D=function(){function t(e,i){var n=this;r(this,t),this.editor=e,this.tweenTime=this.editor.tweenTime,this.timer=this.tweenTime.timer,this.selectionManager=this.editor.selectionManager,this._isDirty=!0,this.timer=this.tweenTime.timer,this.currentTime=this.timer.time,this.onUpdate=this.onUpdate.bind(this),this.initialDomain=[],this.initialDomain[0]=i.domainStart||0,this.initialDomain[1]=i.domainEnd||.2*this.timer.totalDuration,this.initialDomain[0]>this.timer.getCurrentTime()&&(this.timer.time[0]=this.initialDomain[0]);var a={top:6,right:20,bottom:0,left:265};this.margin=a;var s=window.innerWidth-a.left-a.right,l=270-a.top-a.bottom-40;this.lineHeight=20,this.label_position_x=-a.left+20,this.x=T.time.scale().domain(this.initialDomain).range([0,s]),this.xAxis=T.svg.axis().scale(this.x).orient("top").tickSize(-l,0).tickFormat(o["default"].formatMinutes),this.svg=T.select(e.$timeline.get(0)).select(".timeline__main").append("svg").attr("width",s+a.left+a.right).attr("height",600),this.svgContainer=this.svg.append("g").attr("transform","translate("+a.left+","+a.top+")"),this.svgContainerTime=this.svg.append("g").attr("transform","translate("+a.left+",0)"),this.linesContainer=this.svg.append("g").attr("transform","translate("+a.left+","+a.top+")"),this.header=new u["default"](e,this.timer,this.initialDomain,this.tweenTime,s,a),this.timeIndicator=new h["default"](this,this.svgContainerTime),this.selection=new x["default"](this,this.svg,a),this.items=new p["default"](this,this.linesContainer),this.items.onUpdate.add(this.onUpdate),this.keysPreview=new v["default"](this,this.linesContainer),this.properties=new y["default"](this),this.properties.onKeyAdded.add(function(t,e){n._isDirty=!0,n.render(0,!1),n.keys.selectNewKey(t,e)}),this.errors=new k["default"](this),this.keys=new b["default"](this),this.keys.onKeyUpdated.add(function(){n.onUpdate()}),this.xAxisGrid=T.svg.axis().scale(this.x).ticks(100).tickSize(-this.items.dy,0).tickFormat("").orient("top"),this.xGrid=this.svgContainer.append("g").attr("class","x axis grid").attr("transform","translate(0,"+a.top+")").call(this.xAxisGrid),this.xAxisElement=this.svgContainer.append("g").attr("class","x axis").attr("transform","translate(0,"+a.top+")").call(this.xAxis),this.header.onBrush.add(function(t){n.x.domain(t),n.xGrid.call(n.xAxisGrid),n.xAxisElement.call(n.xAxis),n._isDirty=!0}),window.requestAnimationFrame(function(){n.render()}),window.onresize=function(){var t=window.innerWidth,e=t-a.left-a.right;n.svg.attr("width",e+a.left+a.right),n.svg.selectAll(".timeline__right-mask").attr("width",t),n.x.range([0,e]),n._isDirty=!0,n.header.resize(t),n.render()}}return a(t,[{key:"onUpdate",value:function(){this.editor.render(!1,!1,!0)}},{key:"render",value:function(t,e){if(e){var i,n=16;this.timer.getCurrentTime()>this.initialDomain[1]&&(i=this.initialDomain[1]-this.initialDomain[0],this.initialDomain[0]+=i-n,this.initialDomain[1]+=i-n,this.header.setDomain(this.initialDomain)),this.timer.getCurrentTime()<this.initialDomain[0]&&(i=this.initialDomain[1]-this.initialDomain[0],this.initialDomain[0]=this.timer.getCurrentTime(),this.initialDomain[1]=this.initialDomain[0]+i,this.header.setDomain(this.initialDomain))}if((this._isDirty||e)&&(this.header.render(),this.timeIndicator.render()),this._isDirty){var r=this.items.render();this.keysPreview.render(r);var a=this.properties.render(r);this.errors.render(a),this.keys.render(a),this._isDirty=!1;var s=Math.max(this.items.dy+30,230);this.xAxis.tickSize(-s,0),this.xAxisGrid.tickSize(-s,0),this.xGrid.call(this.xAxisGrid),this.xAxisElement.call(this.xAxis),this.svg.attr("height",s),this.timeIndicator.updateHeight(s)}}}]),t}();e["default"]=D},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(1),o=n(s),l=i(9),u=i(3),c=function(){function t(e,i,n,a,s,c){r(this,t),this.timer=i,this.initialDomain=n,this.tweenTime=a,this.onBrush=new u.Signal,this.margin={top:10,right:20,bottom:0,left:c.left},this.height=50-this.margin.top-this.margin.bottom+20,this.currentTime=this.timer.time,this.x=l.time.scale().range([0,s]),this.x.domain([0,this.timer.totalDuration]),this.xDisplayed=l.time.scale().range([0,s]),this.xDisplayed.domain(this.initialDomain),this.xAxis=l.svg.axis().scale(this.x).orient("top").tickSize(-5,0).tickFormat(o["default"].formatMinutes),this.svg=l.select(e.$timeline.get(0)).select(".timeline__header").append("svg").attr("width",s+this.margin.left+this.margin.right).attr("height",56),this.svgContainer=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.createBrushHandle(),this.createTimeHandle(),this.timer.durationChanged.add(this.onDurationChanged)}return a(t,[{key:"adaptDomainToDuration",value:function(t,e){var i=1e3*e,n=[t[0],t[1]];return n[0]=Math.min(n[0],i),n[1]=Math.min(n[1],i),n[0]=Math.max(n[0],0),n}},{key:"setDomain",value:function(){this.brush.x(this.x).extent(this.initialDomain),this.svgContainer.select(".brush").call(this.brush),this.onBrush.dispatch(this.initialDomain),this.render(),this.xDisplayed.domain(this.initialDomain)}},{key:"onDurationChanged",value:function(t){this.x.domain([0,this.timer.totalDuration]),this.xAxisElement.call(this.xAxis),this.initialDomain=this.adaptDomainToDuration(this.initialDomain,t),this.setDomain(this.initialDomain)}},{key:"createBrushHandle",value:function(){var t=this;this.xAxisElement=this.svgContainer.append("g").attr("class","x axis").attr("transform","translate(0,"+(this.margin.top+7)+")").call(this.xAxis);var e=function(){var e=t.brush.extent(),i=e[0].getTime(),n=e[1].getTime();t.initialDomain[0]=i,t.initialDomain[1]=n,t.setDomain(t.initialDomain)};this.brush=l.svg.brush().x(this.x).extent(this.initialDomain).on("brush",e),this.gBrush=this.svgContainer.append("g").attr("class","brush").call(this.brush).selectAll("rect").attr("height",20)}},{key:"render",value:function(){var t=this.svgContainer.selectAll(".time-indicator");t.attr("transform","translate("+this.xDisplayed(this.currentTime[0])+", 25)")}},{key:"createTimeHandle",value:function(){var t=this,e=function(){var e=l.event.sourceEvent;e.stopPropagation();var i=t.tweenTime,n=void 0!==e.x?e.x:e.clientX,r=t.xDisplayed.invert(n-t.margin.left);r=r.getTime(),r=Math.max(0,r);var a=!1;if(e.shiftKey){var s=r/1e3;a=o["default"].getClosestTime(i.data,s,"---non-existant",!1,!1,.3),a!==!1&&(a=1e3*a)}a===!1&&(a=r),t.timer.seek([a])},i=l.behavior.drag().origin(function(t){return t}).on("drag",e),n=this.svgContainer.selectAll(".time-indicator").data(this.currentTime);n.enter().append("rect").attr("x",0).attr("y",20).attr("width",t.xDisplayed(t.timer.totalDuration)).attr("height",50).attr("fill-opacity",0).on("click",function(){var e=l.mouse(this),i=t.xDisplayed.invert(e[0]);i=i.getTime(),i=Math.max(0,i),t.timer.seek([i])});var r=n.enter().append("g").attr("class","time-indicator").attr("transform","translate(-0.5,30)").call(i);r.append("rect").attr("class","time-indicator__line").attr("x",-.5).attr("y",0).attr("width",1).attr("height",1e3),r.append("path").attr("class","time-indicator__handle").attr("d","M -5 -3 L -5 5 L 0 10 L 5 5 L 5 -3 L -5 -3"),this.svgContainer.append("rect").attr("class","graph-mask").attr("x",-t.margin.left).attr("y",-t.margin.top).attr("width",t.margin.left-5).attr("height",t.height)}},{key:"resize",value:function(t){var e=t-this.margin.left-this.margin.right;this.svg.attr("width",e+this.margin.left+this.margin.right),this.x.range([0,e]),this.xDisplayed.range([0,e]),this.xAxisElement.call(this.xAxis)}}]),t}();e["default"]=c},function(t,e){t.exports=i},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e,n){i(this,t),this.timeline=e,this.container=n,this.timeSelection=this.container.selectAll(".time-indicator").data(this.timeline.currentTime),this.timeGrp=this.timeSelection.enter().append("svg").attr("class","time-indicator timeline__right-mask").attr("width",window.innerWidth-this.timeline.label_position_x).attr("height",442),this.timeSelection=this.timeGrp.append("rect").attr("class","time-indicator__line").attr("x",0).attr("y",-this.timeline.margin.top-5).attr("width",1).attr("height",1e3),this.timeSelection=this.container.selectAll(".time-indicator rect")}return n(t,[{key:"updateHeight",value:function(t){this.timeGrp.attr("height",t),this.timeSelection.attr("height",t+this.timeline.margin.top+5)}},{key:"render",value:function(){this.timeSelection.attr("transform","translate("+(this.timeline.x(this.timeline.currentTime[0])-.5)+",0)")}}]),t}();e["default"]=r},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(1),o=n(s),l=i(9),u=i(3),c=i(6),h=function(){function t(e,i){r(this,t),this.timeline=e,this.container=i,this.dy=10+this.timeline.margin.top,this.onUpdate=new u.Signal}return a(t,[{key:"render",value:function(){var t=this,e=t.timeline.tweenTime,i=function(){var e=l.select(this).datum();t.timeline.selectionManager.select(e)},n=function(e){var i=t.timeline.x.invert(l.event.x).getTime()/1e3,n=i-e.start;if(e.start+=n,e.end+=n,e.properties)for(var r=0;r<e.properties.length;r++)for(var a=e.properties[r],s=0;s<a.keys.length;s++){var o=a.keys[s];o.time+=n}e._isDirty=!0,t.onUpdate.dispatch()},r=function(i){l.event.sourceEvent.stopPropagation();var n=l.event.sourceEvent,r=t.timeline.x.invert(l.event.x).getTime()/1e3,a=!1;if(n.shiftKey&&(a=o["default"].getClosestTime(e.data,r,i.id,!1,e.timer)),!a){var s=r-i.start;a=i.start+s}i.start=a,i._isDirty=!0,t.onUpdate.dispatch()},a=function(i){l.event.sourceEvent.stopPropagation();var n=l.event.sourceEvent,r=t.timeline.x.invert(l.event.x).getTime()/1e3,a=!1;if(n.shiftKey&&(a=o["default"].getClosestTime(e.data,r,!1,!1,e.timer)),!a){var s=r-i.end;a=i.end+s}i.end=a,i._isDirty=!0,t.onUpdate.dispatch()},s=l.behavior.drag().origin(function(){var t=l.select(this);return{x:t.attr("x"),y:t.attr("y")}}).on("drag",r),u=l.behavior.drag().origin(function(){var t=l.select(this);return{x:t.attr("x"),y:t.attr("y")}}).on("drag",a),h=l.behavior.drag().origin(function(){var t=l.select(this);return{x:t.attr("x"),y:t.attr("y")}}).on("drag",n),d=1,p=this.container.selectAll(".line-grp").data(this.timeline.tweenTime.data,function(t){return t.id}),f=p.enter().append("g").attr("class","line-grp"),v=f.append("svg").attr("class","timeline__right-mask").attr("width",window.innerWidth-t.timeline.label_position_x).attr("height",t.timeline.lineHeight);v.append("rect").attr("class","bar").attr("id",function(){return o["default"].guid()}).attr("y",3).attr("height",14),v.append("rect").attr("class","bar-anchor bar-anchor--left").attr("y",2).attr("height",16).attr("width",6).call(s),v.append("rect").attr("class","bar-anchor bar-anchor--right").attr("y",2).attr("height",16).attr("width",6).call(u),t.dy=10+this.timeline.margin.top,p.attr("transform",function(e){var i=t.dy;if(t.dy+=t.timeline.lineHeight,!e.collapsed){var n=0;if(e.properties){var r=c.filter(e.properties,function(t){return t.keys.length});n=r.length}t.dy+=n*t.timeline.lineHeight}return"translate(0,"+i+")"});var m=function(t){return void 0!==t.start&&void 0!==t.end};return p.selectAll(".bar-anchor--left").filter(m).attr("x",function(e){return t.timeline.x(1e3*e.start)-1}).on("mousedown",function(){l.event.stopPropagation()}),p.selectAll(".bar-anchor--right").filter(m).attr("x",function(e){return t.timeline.x(1e3*e.end)-1}).on("mousedown",function(){l.event.stopPropagation()}),p.selectAll(".bar").filter(m).attr("x",function(e){return t.timeline.x(1e3*e.start)+d}).attr("width",function(e){return Math.max(0,1e3*(t.timeline.x(e.end)-t.timeline.x(e.start))-d)}).call(h).on("click",i).on("mousedown",function(){l.event.stopPropagation()}),f.append("text").attr("class","line-label").attr("x",t.timeline.label_position_x+10).attr("y",16).text(function(t){return t.label}).on("click",i).on("mousedown",function(){l.event.stopPropagation()}),f.append("text").attr("class","line__toggle").attr("x",t.timeline.label_position_x-10).attr("y",16).on("click",function(e){e.collapsed=!e.collapsed,t.onUpdate.dispatch()}),p.selectAll(".line__toggle").text(function(t){return t.collapsed?"▸":"▾"}),f.append("line").attr("class","line-separator").attr("x1",-t.timeline.margin.left).attr("x2",t.timeline.x(t.timeline.timer.totalDuration+100)).attr("y1",t.timeline.lineHeight).attr("y2",t.timeline.lineHeight),p.exit().remove(),p}}]),t}();e["default"]=h},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(9),s=function(){function t(e,i){n(this,t),this.timeline=e,this.container=i}return r(t,[{key:"render",value:function(t){var e=this,i=function(t){return t.properties?t.properties:[]},n=function(t){return t.name},r=t.selectAll(".keys-preview").data(i,n);r.enter().append("svg").attr("class","keys-preview timeline__right-mask").attr("width",window.innerWidth-e.timeline.label_position_x).attr("height",e.timeline.lineHeight);var s=function(){var t=a.select(this.parentNode.parentNode),e=t.datum();return e.collapsed===!0?"":"display: none;"};r.selectAll(".key--preview").attr("style",s);var o=function(t){return t.keys},l=function(t){return t.time},u=r.selectAll(".key--preview").data(o,l);u.enter().append("path").attr("class","key--preview").attr("style",s).attr("d","M 0 -4 L 4 0 L 0 4 L -4 0"),u.attr("transform",function(t){var i=e.timeline.x(1e3*t.time);i=parseInt(i,10);var n=11;return"translate("+i+","+n+")"}),u.exit().remove()}}]),t}();e["default"]=s},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(1),o=n(s),l=i(9),u=i(3),c=function(){function t(e){r(this,t),this.timeline=e,this.onKeyAdded=new u.Signal,this.subGrp=!1}return a(t,[{key:"render",value:function(t){var e=this,i=this.timeline.editor,n=i.tweenTime,r=function(t){return t.properties?t.properties.filter(function(t){return t.keys.length}):[]},a=function(t){return t.name},s=t.selectAll(".line-item").data(r,a),u=s.enter().append("g").attr("class","line-item");return e.subGrp=u,s.attr("transform",function(t,i){var n=(i+1)*e.timeline.lineHeight;return"translate(0,"+n+")"}),u.append("rect").attr("class","click-handler click-handler--property").attr("x",0).attr("y",0).attr("width",e.timeline.x(e.timeline.timer.totalDuration+100)).attr("height",e.timeline.lineHeight).on("dblclick",function(t){var i=this.parentNode.parentNode,r=l.select(i).datum(),a=t["default"]?t["default"]:0,s=l.mouse(this),u=e.timeline.x.invert(s[0]);u=u.getTime()/1e3;var c=o["default"].getPreviousKey(t.keys,u);c&&(a=c.val),t._line=r;var h={time:u,val:a,_property:t};n.options.defaultEase&&(h.ease=n.options.defaultEase),t.keys.push(h),t.keys=o["default"].sortKeys(t.keys),r._isDirty=!0,r._isDirty=!0;var d=this.parentNode;e.onKeyAdded.dispatch(h,d)}),u.append("svg").attr("class","line-item__keys timeline__right-mask").attr("width",window.innerWidth-e.timeline.label_position_x).attr("height",e.timeline.lineHeight).attr("fill","#f00"),u.append("text").attr("class","line-label line-label--small").attr("x",e.timeline.label_position_x+10).attr("y",15).text(function(t){return t.name}),u.append("line").attr("class","line-separator--secondary").attr("x1",-e.timeline.margin.left).attr("x2",e.timeline.x(e.timeline.timer.totalDuration+100)).attr("y1",e.timeline.lineHeight).attr("y2",e.timeline.lineHeight),t.selectAll(".line-item").attr("display",function(){var t=this.parentNode,e=l.select(t).datum();return e.collapsed?"none":"block"}),s.exit().remove(),s}}]),t}();e["default"]=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(1),o=n(s),l=i(9),u=i(3),c=i(6),h=function(){function t(e){r(this,t),this.timeline=e,this.onKeyUpdated=new u.Signal}return a(t,[{key:"selectNewKey",value:function(t,e){var i=this,n=l.select(e).selectAll(".key").filter(function(e){return e.time===t.time});n.length&&(l.selectAll(".key--selected").classed("key--selected",!1),n.classed("key--selected",!0),n=n[0][0],t._dom=n,i.timeline.selectionManager.select(t))}},{key:"render",value:function(t){var e=this,i=e.timeline.tweenTime,n=function(t){var n=l.event.sourceEvent,r=this.parentNode,a=r.parentNode.parentNode,s=l.select(r).datum(),u=l.select(a).datum(),h=t,d=e.timeline.x.domain()[0],p=l.mouse(this),f=t.time,v=e.timeline.x.invert(p[0]);v=v.getTime(),v=v/1e3-d/1e3,v=t.time+v;var m=e.timeline.selectionManager.getSelection(),y=!1,g=!1;m.length&&(y=m[0].time,g=m[m.length-1].time),m=c.filter(m,function(t){return c.isEqual(t,h)===!1});var b=!1;n.shiftKey&&(b=o["default"].getClosestTime(i.data,v,u.id,s.name,i.timer)),b===!1&&(b=v),t.time=b,s.keys=o["default"].sortKeys(s.keys);var _=t.time-f,k=function(t){var e=t._property;e._line._isDirty=!0,e.keys=o["default"].sortKeys(e.keys)},w=!1,x=!1;if(m.length){n.altKey&&y!==!1&&g!==!1&&(x=y===f,w=x?(g-t.time)/(g-f):(t.time-y)/(f-y));for(var T=0;T<m.length;T++){var D=m[T];w===!1?D.time+=_:x?D.time=g-(g-D.time)*w:D.time=y+(D.time-y)*w,k(D)}}u._isDirty=!0,e.onKeyUpdated.dispatch()},r=function(t){return t.keys},a=function(t){return t._id||(t._id=o["default"].guid()),t._id},s=t.select(".line-item__keys").selectAll(".key").data(r,a),u=function(){var t=l.event;t.sourceEvent&&(t=t.sourceEvent);var i=t.shiftKey;if(!l.event.type||"dragstart"!==l.event.type||!l.select(this).classed("key--selected")){var n=l.select(this).datum();n._dom=this,e.timeline.selectionManager.select(n,i)}},h=function(){e.timeline.editor.undoManager.addState()},d=l.behavior.drag().origin(function(t){return t}).on("drag",n).on("dragstart",u).on("dragend",h),p=s.enter().append("g").attr("class","key").attr("id",function(t){return t._id}).on("mousedown",function(){l.event.stopPropagation()}).call(d);t.selectAll(".key").attr("class",function(t){var e="key";if(l.select(this).classed("key--selected")&&(e+=" key--selected"),t.ease){var i=t.ease.split(".");2===i.length&&(e+=" "+i[1])}else e+=" easeOut";return e});var f=p.append("g").attr("class","ease-linear");f.append("path").attr("class","key__shape-arrow").attr("d","M 0 -6 L 6 0 L 0 6"),f.append("path").attr("class","key__shape-arrow").attr("d","M 0 -6 L -6 0 L 0 6");var v=p.append("g").attr("class","ease-in");v.append("path").attr("class","key__shape-rect").attr("d","M 0 -6 L 0 6 L 4 5 L 1 0 L 4 -5"),v.append("path").attr("class","key__shape-arrow").attr("d","M 0 -6 L -6 0 L 0 6");var m=p.append("g").attr("class","ease-out");m.append("path").attr("class","key__shape-rect").attr("d","M 0 -6 L 0 6 L -4 5 L -1 0 L -4 -5"),m.append("path").attr("class","key__shape-arrow").attr("d","M 0 -6 L 6 0 L 0 6");var y=p.append("g").attr("class","ease-inout");y.append("circle").attr("cx",0).attr("cy",0).attr("r",5),s.attr("transform",function(t){var i=e.timeline.x(1e3*t.time);i=parseInt(i,10);var n=10;return"translate("+i+","+n+")"}),s.exit().remove()}}]),t}();e["default"]=h},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){i(this,t),this.timeline=e}return n(t,[{key:"render",value:function(t){var e=this,i=e.timeline.properties.subGrp,n=function(t){return void 0!==t.errors};i.insert("svg",":first-child").attr("class","line-item__errors").attr("width",window.innerWidth-e.timeline.label_position_x).attr("height",e.timeline.lineHeight);var r=function(t){return t.errors},a=function(t){return t.time},s=t.filter(n).select(".line-item__errors").selectAll(".error").data(r,a);s.enter().append("rect").attr("class","error").attr("width",4).attr("height",e.timeline.lineHeight-1).attr("y","1"),t.selectAll(".error").attr("x",function(t){var i;return i=e.timeline.x(1e3*t.time)}),s.exit().remove()}}]),t}();e["default"]=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(9),s=function(){function t(e,i,r){n(this,t),this.timeline=e,this.svg=i,this.margin=r,this.onMouseUp=this.onMouseUp.bind(this),this.init()}return r(t,[{key:"onMouseUp",value:function(){this.svg.selectAll(".selection").remove(),$("body").css({"user-select":"all"})}},{key:"init",value:function(){var t=this;this.svg.on("mousedown",function(){var e=a.mouse(this);e[0]<t.timeline.margin.left||(t.svg.append("rect").attr({"class":"selection",x:e[0],y:e[1],width:0,height:0}),t.timeline.selectionManager.reset(),$("body").css({"user-select":"none"}))}).on("mousemove",function(){var e=t.svg.select(".selection");if(!e.empty()){var i=a.mouse(this),n={x:parseInt(e.attr("x"),10),y:parseInt(e.attr("y"),10),width:parseInt(e.attr("width"),10),height:parseInt(e.attr("height"),10)};i[0]=Math.max(t.margin.left,i[0]);var r={x:i[0]-n.x,y:i[1]-n.y};r.x<1||2*r.x<n.width?(n.x=i[0],n.width-=r.x):n.width=r.x,r.y<1||2*r.y<n.height?(n.y=i[1],n.height-=r.y):n.height=r.y,e.attr(n),n.x-=t.margin.left;var s=6;n.timeStart=t.timeline.x.invert(n.x-s).getTime()/1e3,n.timeEnd=t.timeline.x.invert(n.x+n.width+s).getTime()/1e3;var o=t.svg[0][0].getBoundingClientRect();a.selectAll(".key--selected").classed("key--selected",!1),t.timeline.selectionManager.reset();var l=[];a.selectAll(".key").each(function(t){var e=a.select(this.parentNode.parentNode.parentNode).datum(),i=a.select(this).datum();if(i._dom=this,e.collapsed!==!0){var r=a.select(this)[0][0].getBoundingClientRect(),s=r.top-o.top;t.time>=n.timeStart&&t.time<=n.timeEnd&&(s>=n.y&&s<=n.y+n.height||s+10>=n.y&&s+10<=n.y+n.height)&&(a.select(this).classed("key--selected",!0),l.push(i))}}),t.timeline.selectionManager.select(l)}}),$(window).on("mouseup",this.onMouseUp)}}]),t}();e["default"]=s},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(18);var s=i(19),o=n(s),l=i(3),u=i(32),c=function(){function t(e){r(this,t),this.editor=e,this.render=this.render.bind(this),this.addProperty=this.addProperty.bind(this),this.onSelect=this.onSelect.bind(this),this.onKeyAdded=this.onKeyAdded.bind(this),this.timeline=this.editor.timeline,this.timer=this.editor.timer,this.selectionManager=e.selectionManager,this.$el=$(u()),this.$container=this.$el.find(".properties-editor__main"),this.keyAdded=new l.Signal,this.keyRemoved=new l.Signal,this.items=[],this.parentElement=e.el,this.parentElement.addClass("properties-is-closed"),this.parentElement.append(this.$el),this.selectionManager.onSelect.add(this.onSelect),this.$el.keypress(function(t){return t.stopPropagation()})}return a(t,[{key:"onKeyAdded",value:function(){this.keyAdded.dispatch()}},{key:"onSelect",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];if(this.items.forEach(function(t){t.remove();
}),this.items=[],this.$container.empty(),t instanceof Array)for(var e=0;e<t.length;e++)this.addProperty(t[e]);else this.addProperty(t);this.items.length&&this.parentElement.removeClass("properties-is-closed")}},{key:"addProperty",value:function(t){var e=new o["default"](this.editor,this.$container,t);e.keyAdded.add(this.onKeyAdded),this.items.push(e)}},{key:"render",value:function(t,e){e&&this.items.forEach(function(t){t.update()})}}]),t}();e["default"]=c},function(t,e){t.exports=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(20),o=n(s),l=i(27),u=n(l),c=i(30),h=n(c),d=i(3),p=function(){function t(e,i,n){r(this,t),this.editor=e,this.$el=i,this.onKeyAdded=this.onKeyAdded.bind(this),this.timeline=e.timeline,this.timer=e.timer,this.selectionManager=e.selectionManager,this.keyAdded=new d.Signal,this.items=[],this.numberProp=!1,this.tweenProp=!1;var a=!1,s=!1,o=!1;n._property&&(s=n._property,o=s._line,a=n),n.id&&(o=n);var l=!1;s&&(l=s.name);var u=this.getContainer(o),c=u;for(var h in o.properties)if(o.properties.hasOwnProperty(h)){var p=o.properties[h];if(!l||p.name===l){var f=this.getGroupContainer(p,u),v=this.addNumberProperty(p,o,a,f);if(this.items.push(v),p.name===l&&(c=f),l){var m=this.addTweenProperty(p,o,a,c,s);this.items.push(m)}}}}return a(t,[{key:"onKeyAdded",value:function(){this.keyAdded.dispatch()}},{key:"getGroupContainer",value:function(t,e){var i,n,r;if(!t.group)return r="property-grp--general",i=e.find("."+r),i.length?i:(n=this.createGroupContainer(r),e.append(n),n);var a=t.group.replace(/\s+/g,"-").toLowerCase();return r="property-grp--"+a,i=e.find("."+r),i.length?i:(n=this.createGroupContainer(r,t.group),e.append(n),n)}},{key:"createGroupContainer",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=$('<div class="property-grp '+t+'"></div>');return e&&i.append('<h3 class="property-grp__title">'+e+"</h3>"),i}},{key:"getContainer",value:function(t){var e=!1;return t.id&&(e=$("#property--"+t.id),e.length||(e=e=$('<div class="properties__wrapper" id="property--'+t.id+'"></div>'),this.$el.append(e),t.label&&e.append('<h2 class="properties-editor__title">'+t.label+"</h2>"))),e===!1&&(e=$('<div class="properties__wrapper" id="no-item"></div>'),this.$el.append(e)),e}},{key:"remove",value:function(){this.items.forEach(function(t){t.remove()}),this.keyAdded&&this.keyAdded.dispose(),delete this.editor,delete this.$el,delete this.timeline,delete this.timer,delete this.selectionManager,delete this.keyAdded,delete this.items,delete this.numberProp,delete this.tweenProp}},{key:"addNumberProperty",value:function(t,e,i,n){var r=o["default"];t.type&&"color"===t.type&&(r=u["default"]);var a=new r(t,e,this.editor,i);return a.keyAdded.add(this.onKeyAdded),n.append(a.$el),a}},{key:"addTweenProperty",value:function(t,e,i,n,r){var a=this,s=new h["default"](t,e,this.editor,i,this.timeline);return n.append(s.$el),s.$el.find("[data-action-remove]").click(function(t){t.preventDefault();var n=r.keys.indexOf(i);n>-1&&(r.keys.splice(n,1),i._dom&&a.editor.propertiesEditor.keyRemoved.dispatch(i),e._isDirty=!0)}),s}},{key:"update",value:function(){for(var t=0;t<this.items.length;t++){var e=this.items[t];e.update()}}}]),t}();e["default"]=p},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function f(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:f(r,e,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)};i(18);var u=i(21),c=n(u),h=i(22),d=i(23),p=function(t){function e(t,i,n){var s=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];r(this,e);var o=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,s));return o.onInputChange=o.onInputChange.bind(o),o.$input=o.$el.find("input"),o}return s(e,t),o(e,[{key:"getInputVal",value:function(){return parseFloat(this.$el.find("input").val())}},{key:"render",value:function(){var t=this;l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this);var i=this.getCurrentVal(),n={id:this.instance_property.name,label:this.instance_property.label||this.instance_property.name,val:i},r=d(n);this.$el=$(r),this.$el.find(".property__key").click(this.onKeyClick);var a=this.$el.find("input"),s=function(){t.editor.undoManager.addState()},o={changeCallback:function(){return t.onInputChange()},endCallback:function(){return s()}};"min"in this.instance_property&&(o.min=this.instance_property.min),"max"in this.instance_property&&(o.max=this.instance_property.max);var u=new h(a.get(0),o);a.data("draggable",u),a.change(this.onInputChange)}},{key:"remove",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this),this.$input.data("draggable")&&this.$input.data("draggable").destroy(),delete this.$input,delete this.$el}},{key:"update",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this);var t=this.getCurrentVal(),i=this.$input.data("draggable");i?i.set(t.toFixed(3)):this.$input.val(t.toFixed(3))}}]),e}(c["default"]);e["default"]=p},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(1),o=n(s),l=i(3),u=i(6),c=function(){function t(e,i,n){var a=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];r(this,t),this.instance_property=e,this.lineData=i,this.editor=n,this.key_val=a,this.onInputChange=this.onInputChange.bind(this),this.onKeyClick=this.onKeyClick.bind(this),this.timer=n.timer,this.keyAdded=new l.Signal,this.render(),this.$key=this.$el.find(".property__key")}return a(t,[{key:"onKeyClick",value:function(t){t.preventDefault();var e=this.getCurrentVal();this.addKey(e)}},{key:"getInputVal",value:function(){return this.$el.find("input").val()}},{key:"getCurrentVal",value:function(){var t=this.instance_property.val,e=this.instance_property.name;return this.key_val?this.key_val.val:void 0!==this.lineData.values&&this.lineData.values[e]?this.lineData.values[e]:t}},{key:"onInputChange",value:function(){var t=this.getInputVal(),e=this.timer.getCurrentTime()/1e3;if(this.key_val&&(e=this.key_val.time),this.instance_property.keys&&this.instance_property.keys.length){var i=u.find(this.instance_property.keys,function(t){return t.time===e});i?i.val=t:this.addKey(t)}else this.instance_property.val=t,this.lineData.values[this.instance_property.name]=t,this.lineData.object&&(e=this.timer.getCurrentTime()/1e3,this.lineData.object.update(e-this.lineData.start));this.lineData._isDirty=!0}},{key:"getCurrentKey",value:function(){var t=this.timer.getCurrentTime()/1e3;if(!this.instance_property||!this.instance_property.keys)return!1;if(0===this.instance_property.keys.length)return!1;for(var e=0;e<this.instance_property.keys.length;e++){var i=this.instance_property.keys[e];if(i.time===t)return i}return!1}},{key:"addKey",value:function(t){var e=this.editor.tweenTime,i=this.timer.getCurrentTime()/1e3,n={time:i,val:t};e.options.defaultEase&&(n.ease=e.options.defaultEase),this.instance_property.keys.push(n),this.instance_property.keys=o["default"].sortKeys(this.instance_property.keys),this.lineData._isDirty=!0,this.keyAdded.dispatch()}},{key:"render",value:function(){this.values=void 0!==this.lineData.values?this.lineData.values:{}}},{key:"update",value:function(){var t=this.getCurrentKey();this.$key.toggleClass("property__key--active",t)}},{key:"remove",value:function(){this.keyAdded&&this.keyAdded.dispose(),delete this.instance_property,delete this.lineData,delete this.editor,delete this.key_val,delete this.timer,delete this.keyAdded,delete this.$key}}]),t}();e["default"]=c},function(t,e){t.exports=r},function(t,e,i){var n=i(24);t.exports=function(){var t=new n.Template({code:function(t,e,i){var n=this;return n.b(i=i||""),n.b('<div class="property property--number">'),n.b("\n"+i),n.b('  <button class="property__key"></button>'),n.b("\n"+i),n.b('  <label for="'),n.b(n.v(n.f("id",t,e,0))),n.b('" class="property__label">'),n.b(n.v(n.f("label",t,e,0))),n.b("</label>"),n.b("\n"+i),n.b('  <input type="number" id="'),n.b(n.v(n.f("id",t,e,0))),n.b('" class="property__input" value="'),n.b(n.v(n.f("val",t,e,0))),n.b('" />'),n.b("\n"+i),n.b("</div>"),n.b("\n"),n.fl()},partials:{},subs:{}},'<div class="property property--number">\n  <button class="property__key"></button>\n  <label for="{{id}}" class="property__label">{{label}}</label>\n  <input type="number" id="{{id}}" class="property__input" value="{{val}}" />\n</div>\n',n);return t.render.apply(t,arguments)}},function(t,e,i){var n=i(25);n.Template=i(26).Template,n.template=n.Template,t.exports=n},function(t,e,i){!function(t){function e(t){"}"===t.n.substr(t.n.length-1)&&(t.n=t.n.substring(0,t.n.length-1))}function i(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}function n(t,e,i){if(e.charAt(i)!=t.charAt(0))return!1;for(var n=1,r=t.length;n<r;n++)if(e.charAt(i+n)!=t.charAt(n))return!1;return!0}function r(e,i,n,o){var l=[],u=null,c=null,h=null;for(c=n[n.length-1];e.length>0;){if(h=e.shift(),c&&"<"==c.tag&&!(h.tag in k))throw new Error("Illegal content in < super tag.");if(t.tags[h.tag]<=t.tags.$||a(h,o))n.push(h),h.nodes=r(e,h.tag,n,o);else{if("/"==h.tag){if(0===n.length)throw new Error("Closing tag without opener: /"+h.n);if(u=n.pop(),h.n!=u.n&&!s(h.n,u.n,o))throw new Error("Nesting error: "+u.n+" vs. "+h.n);return u.end=h.i,l}"\n"==h.tag&&(h.last=0==e.length||"\n"==e[0].tag)}l.push(h)}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return l}function a(t,e){for(var i=0,n=e.length;i<n;i++)if(e[i].o==t.n)return t.tag="#",!0}function s(t,e,i){for(var n=0,r=i.length;n<r;n++)if(i[n].c==t&&i[n].o==e)return!0}function o(t){var e=[];for(var i in t)e.push('"'+u(i)+'": function(c,p,t,i) {'+t[i]+"}");return"{ "+e.join(",")+" }"}function l(t){var e=[];for(var i in t.partials)e.push('"'+u(i)+'":{name:"'+u(t.partials[i].name)+'", '+l(t.partials[i])+"}");return"partials: {"+e.join(",")+"}, subs: "+o(t.subs)}function u(t){return t.replace(g,"\\\\").replace(v,'\\"').replace(m,"\\n").replace(y,"\\r").replace(b,"\\u2028").replace(_,"\\u2029")}function c(t){return~t.indexOf(".")?"d":"f"}function h(t,e){var i="<"+(e.prefix||""),n=i+t.n+w++;return e.partials[n]={name:t.n,partials:{}},e.code+='t.b(t.rp("'+u(n)+'",c,p,"'+(t.indent||"")+'"));',n}function d(t,e){e.code+="t.b(t.t(t."+c(t.n)+'("'+u(t.n)+'",c,p,0)));'}function p(t){return"t.b("+t+");"}var f=/\S/,v=/\"/g,m=/\n/g,y=/\r/g,g=/\\/g,b=/\u2028/,_=/\u2029/;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(r,a){function s(){g.length>0&&(b.push({tag:"_t",text:new String(g)}),g="")}function o(){for(var e=!0,i=w;i<b.length;i++)if(e=t.tags[b[i].tag]<t.tags._v||"_t"==b[i].tag&&null===b[i].text.match(f),!e)return!1;return e}function l(t,e){if(s(),t&&o())for(var i,n=w;n<b.length;n++)b[n].text&&((i=b[n+1])&&">"==i.tag&&(i.indent=b[n].text.toString()),b.splice(n,1));else e||b.push({tag:"\n"});_=!1,w=b.length}function u(t,e){var n="="+T,r=t.indexOf(n,e),a=i(t.substring(t.indexOf("=",e)+1,r)).split(" ");return x=a[0],T=a[a.length-1],r+n.length-1}var c=r.length,h=0,d=1,p=2,v=h,m=null,y=null,g="",b=[],_=!1,k=0,w=0,x="{{",T="}}";for(a&&(a=a.split(" "),x=a[0],T=a[1]),k=0;k<c;k++)v==h?n(x,r,k)?(--k,s(),v=d):"\n"==r.charAt(k)?l(_):g+=r.charAt(k):v==d?(k+=x.length-1,y=t.tags[r.charAt(k+1)],m=y?r.charAt(k+1):"_v","="==m?(k=u(r,k),v=h):(y&&k++,v=p),_=k):n(T,r,k)?(b.push({tag:m,n:i(g),otag:x,ctag:T,i:"/"==m?_-x.length:k+T.length}),g="",k+=T.length-1,v=h,"{"==m&&("}}"==T?k++:e(b[b.length-1]))):g+=r.charAt(k);return l(_,!0),b};var k={_t:!0,"\n":!0,$:!0,"/":!0};t.stringify=function(e,i,n){return"{code: function (c,p,i) { "+t.wrapMain(e.code)+" },"+l(e)+"}"};var w=0;t.generate=function(e,i,n){w=0;var r={code:"",subs:{},partials:{}};return t.walk(e,r),n.asString?this.stringify(r,i,n):this.makeTemplate(r,i,n)},t.wrapMain=function(t){return'var t=this;t.b(i=i||"");'+t+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(t,e,i){var n=this.makePartials(t);return n.code=new Function("c","p","i",this.wrapMain(t.code)),new this.template(n,e,this,i)},t.makePartials=function(t){var e,i={subs:{},partials:t.partials,name:t.name};for(e in i.partials)i.partials[e]=this.makePartials(i.partials[e]);for(e in t.subs)i.subs[e]=new Function("c","p","t","i",t.subs[e]);return i},t.codegen={"#":function(e,i){i.code+="if(t.s(t."+c(e.n)+'("'+u(e.n)+'",c,p,1),c,p,0,'+e.i+","+e.end+',"'+e.otag+" "+e.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(e.nodes,i),i.code+="});c.pop();}"},"^":function(e,i){i.code+="if(!t.s(t."+c(e.n)+'("'+u(e.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(e.nodes,i),i.code+="};"},">":h,"<":function(e,i){var n={partials:{},code:"",subs:{},inPartial:!0};t.walk(e.nodes,n);var r=i.partials[h(e,i)];r.subs=n.subs,r.partials=n.partials},$:function(e,i){var n={subs:{},code:"",partials:i.partials,prefix:e.n};t.walk(e.nodes,n),i.subs[e.n]=n.code,i.inPartial||(i.code+='t.sub("'+u(e.n)+'",c,p,i);')},"\n":function(t,e){e.code+=p('"\\n"'+(t.last?"":" + i"))},_v:function(t,e){e.code+="t.b(t.v(t."+c(t.n)+'("'+u(t.n)+'",c,p,0)));'},_t:function(t,e){e.code+=p('"'+u(t.text)+'"')},"{":d,"&":d},t.walk=function(e,i){for(var n,r=0,a=e.length;r<a;r++)n=t.codegen[e[r].tag],n&&n(e[r],i);return i},t.parse=function(t,e,i){return i=i||{},r(t,"",[],i.sectionTags||[])},t.cache={},t.cacheKey=function(t,e){return[t,!!e.asString,!!e.disableLambda,e.delimiters,!!e.modelGet].join("||")},t.compile=function(e,i){i=i||{};var n=t.cacheKey(e,i),r=this.cache[n];if(r){var a=r.partials;for(var s in a)delete a[s].instance;return r}return r=this.generate(this.parse(this.scan(e,i.delimiters),e,i),e,i),this.cache[n]=r}}(e)},function(t,e,i){!function(t){function e(t,e,i){var n;return e&&"object"==typeof e&&(void 0!==e[t]?n=e[t]:i&&e.get&&"function"==typeof e.get&&(n=e.get(t))),n}function i(t,e,i,n,r,a){function s(){}function o(){}s.prototype=t,o.prototype=t.subs;var l,u=new s;u.subs=new o,u.subsText={},u.buf="",n=n||{},u.stackSubs=n,u.subsText=a;for(l in e)n[l]||(n[l]=e[l]);for(l in n)u.subs[l]=n[l];r=r||{},u.stackPartials=r;for(l in i)r[l]||(r[l]=i[l]);for(l in r)u.partials[l]=r[l];return u}function n(t){return String(null===t||void 0===t?"":t)}function r(t){return t=n(t),c.test(t)?t.replace(a,"&amp;").replace(s,"&lt;").replace(o,"&gt;").replace(l,"&#39;").replace(u,"&quot;"):t}t.Template=function(t,e,i,n){t=t||{},this.r=t.code||this.r,this.c=i,this.options=n||{},this.text=e||"",this.partials=t.partials||{},this.subs=t.subs||{},this.buf=""},t.Template.prototype={r:function(t,e,i){return""},v:r,t:n,render:function(t,e,i){return this.ri([t],e||{},i)},ri:function(t,e,i){return this.r(t,e,i)},ep:function(t,e){var n=this.partials[t],r=e[n.name];if(n.instance&&n.base==r)return n.instance;if("string"==typeof r){if(!this.c)throw new Error("No compiler available.");r=this.c.compile(r,this.options)}if(!r)return null;if(this.partials[t].base=r,n.subs){e.stackText||(e.stackText={});for(key in n.subs)e.stackText[key]||(e.stackText[key]=void 0!==this.activeSub&&e.stackText[this.activeSub]?e.stackText[this.activeSub]:this.text);r=i(r,n.subs,n.partials,this.stackSubs,this.stackPartials,e.stackText)}return this.partials[t].instance=r,r},rp:function(t,e,i,n){var r=this.ep(t,i);return r?r.ri(e,i,n):""},rs:function(t,e,i){var n=t[t.length-1];if(!h(n))return void i(t,e,this);for(var r=0;r<n.length;r++)t.push(n[r]),i(t,e,this),t.pop()},s:function(t,e,i,n,r,a,s){var o;return(!h(t)||0!==t.length)&&("function"==typeof t&&(t=this.ms(t,e,i,n,r,a,s)),o=!!t,!n&&o&&e&&e.push("object"==typeof t?t:e[e.length-1]),o)},d:function(t,i,n,r){var a,s=t.split("."),o=this.f(s[0],i,n,r),l=this.options.modelGet,u=null;if("."===t&&h(i[i.length-2]))o=i[i.length-1];else for(var c=1;c<s.length;c++)a=e(s[c],o,l),void 0!==a?(u=o,o=a):o="";return!(r&&!o)&&(r||"function"!=typeof o||(i.push(u),o=this.mv(o,i,n),i.pop()),o)},f:function(t,i,n,r){for(var a=!1,s=null,o=!1,l=this.options.modelGet,u=i.length-1;u>=0;u--)if(s=i[u],a=e(t,s,l),void 0!==a){o=!0;break}return o?(r||"function"!=typeof a||(a=this.mv(a,i,n)),a):!r&&""},ls:function(t,e,i,r,a){var s=this.options.delimiters;return this.options.delimiters=a,this.b(this.ct(n(t.call(e,r)),e,i)),this.options.delimiters=s,!1},ct:function(t,e,i){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(t,this.options).render(e,i)},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ms:function(t,e,i,n,r,a,s){var o,l=e[e.length-1],u=t.call(l);return"function"==typeof u?!!n||(o=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(u,l,i,o.substring(r,a),s)):u},mv:function(t,e,i){var r=e[e.length-1],a=t.call(r);return"function"==typeof a?this.ct(n(a.call(r)),r,i):a},sub:function(t,e,i,n){var r=this.subs[t];r&&(this.activeSub=t,r(e,i,this,n),this.activeSub=!1)}};var a=/&/g,s=/</g,o=/>/g,l=/\'/g,u=/\"/g,c=/[&<>\"\']/,h=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}(e)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function p(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:p(r,e,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)};i(18);var u=i(21),c=n(u);i(28);var h=i(29),d=function(t){function e(t,i,n){var s=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];r(this,e);var o=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n,s));return o.onInputChange=o.onInputChange.bind(o),o.$input=o.$el.find("input"),o}return s(e,t),o(e,[{key:"render",value:function(){var t=this;l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this);var i=this.getCurrentVal(),n={id:this.instance_property.name,label:this.instance_property.label||this.instance_property.name,val:i},r=h(n);this.$el=$(r),this.$el.find(".property__key").click(this.onKeyClick);var a=this.$el.find("input");a.spectrum({allowEmpty:!1,showAlpha:!0,clickoutFiresChange:!1,preferredFormat:"rgb",change:function(){t.editor.undoManager.addState()},move:function(e){1===e._a?a.val(e.toHexString()):a.val(e.toRgbString()),t.onInputChange()}}),a.change(this.onInputChange)}},{key:"remove",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"remove",this).call(this),this.$el.find("input").spectrum("destroy"),delete this.$el,delete this.$input}},{key:"update",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var t=this.getCurrentVal();this.$input.val(t),this.$input.spectrum("set",t)}}]),e}(c["default"]);e["default"]=d},function(t,e){t.exports=a},function(t,e,i){var n=i(24);t.exports=function(){var t=new n.Template({code:function(t,e,i){var n=this;return n.b(i=i||""),n.b('<div class="property property--number">'),n.b("\n"+i),n.b('  <button class="property__key"></button>'),n.b("\n"+i),n.b('  <label for="'),n.b(n.v(n.f("id",t,e,0))),n.b('" class="property__label">'),n.b(n.v(n.f("label",t,e,0))),n.b("</label>"),n.b("\n"+i),n.b('  <input id="'),n.b(n.v(n.f("id",t,e,0))),n.b('" class="property__input" value="'),n.b(n.v(n.f("val",t,e,0))),n.b('" />'),n.b("\n"+i),n.b("</div>"),n.b("\n"),n.fl()},partials:{},subs:{}},'<div class="property property--number">\n  <button class="property__key"></button>\n  <label for="{{id}}" class="property__label">{{label}}</label>\n  <input id="{{id}}" class="property__input" value="{{val}}" />\n</div>\n',n);return t.render.apply(t,arguments)}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(18);var a=i(31),s=function(){function t(e,i,r){var a=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],s=!(arguments.length<=4||void 0===arguments[4])&&arguments[4];n(this,t),this.instance_property=e,this.lineData=i,this.editor=r,this.key_val=a,this.timeline=s,this.onChange=this.onChange.bind(this),this.timer=this.editor.timer,this.$time=!1,this.$el=!1,this.render()}return r(t,[{key:"remove",value:function(){delete this.$el,delete this.instance_property,delete this.lineData,delete this.editor,delete this.key_val,delete this.timeline,delete this.timer,delete this.$time}},{key:"render",value:function(){var t=this,e=this;this.key_val.ease||(this.key_val.ease="Quad.easeOut");for(var i={id:this.instance_property.name+"_tween",val:this.key_val.ease,time:this.key_val.time.toFixed(3),options:["Linear.easeNone"],selected:function(){return this.toString()===e.key_val.ease?"selected":""}},n=["Quad","Cubic","Quart","Quint"],r=0;r<n.length;r++){var s=n[r];i.options.push(s+".easeOut"),i.options.push(s+".easeIn"),i.options.push(s+".easeInOut")}this.$el=$(a(i)),this.$time=this.$el.find(".property__key-time strong"),this.$time.keypress(function(e){13===e.charCode&&(e.preventDefault(),t.$time.blur(),t.updateKeyTime(t.$time.text()))}),this.$time.on("click",function(){return document.execCommand("selectAll",!1,null)}),this.$el.find("select").change(this.onChange)}},{key:"updateKeyTime",value:function(t){var e=parseFloat(t);isNaN(e)&&(e=this.key_val.time),this.$time.text(e),this.key_val.time=e,this.onChange()}},{key:"onChange",value:function(){var t=this.$el.find("select").val();this.key_val.ease=t,this.editor.undoManager.addState(),this.lineData._isDirty=!0,this.timeline._isDirty=!0}},{key:"update",value:function(){this.$time.html(this.key_val.time.toFixed(3))}}]),t}();e["default"]=s},function(t,e,i){var n=i(24);t.exports=function(){var t=new n.Template({code:function(t,e,i){var n=this;return n.b(i=i||""),n.b('<div class="property property--tween">'),n.b("\n"+i),n.b('  <label for="'),n.b(n.v(n.f("id",t,e,0))),n.b('" class="property__label">easing</label>'),n.b("\n"+i),n.b('  <div class="property__select">'),n.b("\n"+i),n.b('    <div class="custom-select">'),n.b("\n"+i),n.b('      <select id="'),n.b(n.v(n.f("id",t,e,0))),n.b('">'),n.b("\n"+i),n.s(n.f("options",t,e,1),t,e,0,212,279,"{{ }}")&&(n.rs(t,e,function(t,e,n){n.b('        <option value="'),n.b(n.v(n.d(".",t,e,0))),n.b('" '),n.b(n.v(n.f("selected",t,e,0))),n.b(">"),n.b(n.v(n.d(".",t,e,0))),n.b("</option>"),n.b("\n"+i)}),t.pop()),n.b("      </select>"),n.b("\n"+i),n.b("    </div>"),n.b("\n"+i),n.b("  </div>"),n.b("\n"+i),n.b("</div>"),n.b("\n"+i),n.b('<div class="properties-editor__actions actions">'),n.b("\n"+i),n.b('  <span class="property__key-time">key at <strong class="property__key-input" contenteditable="true">'),n.b(n.v(n.f("time",t,e,0))),n.b("</strong> seconds</span>"),n.b("\n"+i),n.b('  <a href="#" class="actions__item" data-action-remove>Remove key</a>'),n.b("\n"+i),n.b("</div>"),n.fl()},partials:{},subs:{}},'<div class="property property--tween">\n  <label for="{{id}}" class="property__label">easing</label>\n  <div class="property__select">\n    <div class="custom-select">\n      <select id="{{id}}">\n        {{#options}}\n        <option value="{{.}}" {{selected}}>{{.}}</option>\n        {{/options}}\n      </select>\n    </div>\n  </div>\n</div>\n<div class="properties-editor__actions actions">\n  <span class="property__key-time">key at <strong class="property__key-input" contenteditable="true">{{time}}</strong> seconds</span>\n  <a href="#" class="actions__item" data-action-remove>Remove key</a>\n</div>',n);return t.render.apply(t,arguments)}},function(t,e,i){var n=i(24);t.exports=function(){var t=new n.Template({code:function(t,e,i){var n=this;return n.b(i=i||""),n.b('<div class="properties-editor">'),n.b("\n"+i),n.b('  <a href="#" class="menu-item menu-item--toggle-side" data-action="toggle"><i class="icon-toggle"></i></a>'),n.b("\n"+i),n.b('  <div class="properties-editor__main"></div>'),n.b("\n"+i),n.b("</div>"),n.b("\n"),n.fl()},partials:{},subs:{}},'<div class="properties-editor">\n  <a href="#" class="menu-item menu-item--toggle-side" data-action="toggle"><i class="icon-toggle"></i></a>\n  <div class="properties-editor__main"></div>\n</div>\n',n);return t.render.apply(t,arguments)}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(34).saveAs||i(34),s=function(){function t(e,i,r){n(this,t),this.tweenTime=e,this.$timeline=i,this.editor=r,this.timer=this.tweenTime.timer,this.initExport(),this.initToggle()}return r(t,[{key:"initToggle",value:function(){var t=this.editor.el,e=!1,i=this.$timeline.find('[data-action="toggle"]');i.click(function(n){return n.preventDefault(),e=!e,i.toggleClass("menu-item--toggle-up",e),t.toggleClass("timeline-is-closed",e),window.dispatchEvent(new Event("resize"))});var n=$(".properties-editor",t).find('[data-action="toggle"]');n.click(function(e){var i;return e.preventDefault(),i=!t.hasClass("properties-is-closed"),t.toggleClass("properties-is-closed",i),window.dispatchEvent(new Event("resize"))})}},{key:"initExport",value:function(){var t=this.editor.exporter;this.$timeline.find('[data-action="export"]').click(function(e){e.preventDefault();var i=t.getJSON(),n=new Blob([i],{type:"text/json;charset=utf-8"});a(n,"data.json")})}}]),t}();e["default"]=s},function(t,e){t.exports=s},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e,n){var r=this;i(this,t),this.tweenTime=e,this.$timeline=n,this.timer=this.tweenTime.timer,this.$time=this.$timeline.find(".control--time"),this.$time_end=this.$timeline.find(".control--time-end"),this.initControls(),this.$time_end.val(this.tweenTime.timer.getDuration()),$(document).keypress(function(t){32===t.charCode&&r.playPause()})}return n(t,[{key:"playPause",value:function(){var t;this.timer.toggle(),t=this.$timeline.find(".control--play-pause"),t.toggleClass("icon-pause",this.timer.is_playing),t.toggleClass("icon-play",!this.timer.is_playing)}},{key:"initControls",value:function(){var t=this,e=this.$timeline.find(".control--play-pause");e.click(function(e){e.preventDefault(),t.playPause()});var i=this.$timeline.find(".control--first");i.click(function(e){e.preventDefault(),t.timer.seek([0])});var n=this.$timeline.find(".control--last");n.click(function(e){e.preventDefault();var i=t.tweenTime.getTotalDuration();t.timer.seek([1e3*i])}),this.$time.change(function(){var e=1e3*parseFloat(t.$time.val(),10);t.timer.seek([e])}),this.$time_end.change(function(){var e=parseFloat(t.$time_end.val(),10);t.timer.setDuration(e)})}},{key:"render",value:function(t,e){if(e){var i=t/1e3;this.$time.val(i.toFixed(3))}}}]),t}();e["default"]=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(9),s=i(3),o=i(6),l=function(){function t(e){n(this,t),this.tweenTime=e,this.selection=[],this.onSelect=new s.Signal}return r(t,[{key:"select",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(this.addDataRelations(),e||(this.selection=[]),t instanceof Array)for(var i=0;i<t.length;i++){var n=t[i];this.selection.push(n)}else this.selection.push(t);this.removeDuplicates(),this.highlightItems(),this.sortSelection(),this.onSelect.dispatch(this.selection,e)}},{key:"getSelection",value:function(){return this.selection}},{key:"removeDuplicates",value:function(){for(var t=[],e=0;e<this.selection.length;e++){for(var i=this.selection[e],n=!1,r=0;r<t.length;r++){var a=t[r];if(o.isEqual(i,a)){n=!0;break}}n===!1&&t.push(i)}this.selection=t}},{key:"removeItem",value:function(t){if("string"==typeof t){var e=o.find(this.selection,function(e){return e._id===t});if(e)return this.removeItem(e)}var i=this.selection.indexOf(t);i>-1&&this.selection.splice(i,1),this.triggerSelect()}},{key:"sortSelection",value:function(){var t=function(t,e){return t.time&&e.time?t.time<e.time?-1:t.time>e.time?1:0:0};this.selection=this.selection.sort(t)}},{key:"reset",value:function(){this.selection=[],this.highlightItems(),this.onSelect.dispatch(this.selection,!1)}},{key:"triggerSelect",value:function(){this.onSelect.dispatch(this.selection,!1)}},{key:"addDataRelations",value:function(){for(var t=this.tweenTime.data,e=0;e<t.length;e++)for(var i=t[e],n=0;n<i.properties.length;n++){var r=i.properties[n];r._line=i;for(var a=0;a<r.keys.length;a++){
var s=r.keys[a];s._property=r}}}},{key:"highlightItems",value:function(){a.selectAll(".bar--selected").classed("bar--selected",!1),a.selectAll(".key--selected").classed("key--selected",!1);for(var t=0;t<this.selection.length;t++){var e=this.selection[t];if(e._dom){var i=a.select(e._dom);i.classed("bar")?i.classed("bar--selected",!0):i.classed("key")&&i.classed("key--selected",!0)}}}}]),t}();e["default"]=l},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){i(this,t),this.editor=e}return n(t,[{key:"getData",value:function(){var t=this.editor.tweenTime,e=this.editor.timeline.x.domain(),i=e[0],n=e[1];return{settings:{time:t.timer.getCurrentTime(),duration:t.timer.getDuration(),domain:[i.getTime(),n.getTime()]},data:t.data}}},{key:"getJSON",value:function(){var t=this.editor.options,e=function(e,i){if(0!==e.indexOf("_"))return void 0!==t.json_replacer?t.json_replacer(e,i):i},i=this.getData();return JSON.stringify(i,e,2)}}]),t}();e["default"]=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(18);var a=function(){function t(e){var i=this;n(this,t),this.editor=e,this.history_max=100,this.history=[],this.current_index=0,this.addState(),$(document).keydown(function(t){90===t.keyCode&&(t.metaKey||t.ctrlKey)&&(t.shiftKey?i.redo():i.undo())})}return r(t,[{key:"undo",value:function(){return!(this.current_index<=0)&&(this.current_index-=1,void this.setState(this.current_index))}},{key:"redo",value:function(){return!(this.current_index>=this.history.length-1)&&(this.current_index+=1,void this.setState(this.current_index))}},{key:"addState",value:function(){var t=JSON.parse(this.editor.exporter.getJSON());this.current_index+1<this.history.length&&this.history.splice(this.current_index+1,this.history.length-1),this.history.push(t),this.history.length>this.history_max&&this.history.shift(),this.current_index=this.history.length-1}},{key:"setState",value:function(t){for(var e=this.history[t],i=e.data,n=this.editor.tweenTime,r=0;r<i.length;r++){var a=i[r];if(n.data[r])for(var s=0;s<a.properties.length;s++){var o=a.properties[s];if(n.data[r].properties[s])for(var l=n.data[r].properties[s].keys,u=0;u<o.keys.length;u++){var c=o.keys[u];l[u]?(l[u].time=c.time,l[u].val=c.val,l[u].ease=c.ease):l[u]=c}else n.data[r].properties[s]=o}else n.data[r]=a;n.data[r]._isDirty=!0}this.editor.render(!1,!0)}}]),t}();e["default"]=a},function(t,e,i){var n=i(24);t.exports=function(){var t=new n.Template({code:function(t,e,i){var n=this;return n.b(i=i||""),n.b('<div class="timeline">'),n.b("\n"+i),n.b('  <nav class="timeline__menu">'),n.b("\n"+i),n.b('    <a href="#" class="menu-item" data-action="export">Export</a>'),n.b("\n"+i),n.b('    <a href="#" class="menu-item menu-item--toggle" data-action="toggle"><i class="icon-toggle"></i></a>'),n.b("\n"+i),n.b("  </nav>"),n.b("\n"+i),n.b('  <div class="timeline__controls controls">'),n.b("\n"+i),n.b('    <a href="#" class="control control--first icon-backward"></a>'),n.b("\n"+i),n.b('    <a href="#" class="control control--play-pause icon-play"></a>'),n.b("\n"+i),n.b('    <a href="#" class="control control--last icon-forward"></a>'),n.b("\n"+i),n.b('    <input type="text" class="control control--input control--time" /> <span class="control__time-separator">/</span> <input type="text" class="control control--input control--time-end" />'),n.b("\n"+i),n.b("  </div>"),n.b("\n"+i),n.b('  <div class="timeline__header">'),n.b("\n"),n.b("\n"+i),n.b("  </div>"),n.b("\n"+i),n.b('  <div class="timeline__main">'),n.b("\n"),n.b("\n"+i),n.b("  </div>"),n.b("\n"+i),n.b("</div>"),n.b("\n"),n.fl()},partials:{},subs:{}},'<div class="timeline">\n  <nav class="timeline__menu">\n    <a href="#" class="menu-item" data-action="export">Export</a>\n    <a href="#" class="menu-item menu-item--toggle" data-action="toggle"><i class="icon-toggle"></i></a>\n  </nav>\n  <div class="timeline__controls controls">\n    <a href="#" class="control control--first icon-backward"></a>\n    <a href="#" class="control control--play-pause icon-play"></a>\n    <a href="#" class="control control--last icon-forward"></a>\n    <input type="text" class="control control--input control--time" /> <span class="control__time-separator">/</span> <input type="text" class="control control--input control--time-end" />\n  </div>\n  <div class="timeline__header">\n\n  </div>\n  <div class="timeline__main">\n\n  </div>\n</div>\n',n);return t.render.apply(t,arguments)}}])});
//# sourceMappingURL=TweenTime.Editor.min.js.map